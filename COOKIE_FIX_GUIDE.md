# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å Cookie –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö - –û–ë–ù–û–í–õ–ï–ù–û

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å Cookie –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –≤ Production**
- **–ü—Ä–∏—á–∏–Ω–∞:** `sameSite: 'none'` —Ç—Ä–µ–±—É–µ—Ç `secure: true`, –Ω–æ –≤ production –±–µ–∑ HTTPS —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ–º HTTPS –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ cookie

### 2. **–î–≤–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Cookie**
- **–û—Å–Ω–æ–≤–Ω–æ–π cookie:** `auth-token` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
- **–ú–æ–±–∏–ª—å–Ω—ã–π cookie:** `auth-token-mobile` —Å –±–æ–ª–µ–µ –º—è–≥–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### 3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö cookie –≤ middleware
- –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ cookie (secure, sameSite, production mode)

### 4. **Middleware —Å fallback**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–∞ cookie (`auth-token` –∏ `auth-token-mobile`)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª—é–±–æ–π –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç–æ–∫–µ–Ω
- –£–¥–∞–ª—è–µ—Ç –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã

## üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ http://localhost:3000

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### 1. **–û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:**
- http://localhost:3000/courier/login

### 2. **–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫—É—Ä—å–µ—Ä–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"**

### 3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏:**
–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
```
Login successful for courier: [–ò–º—è –∫—É—Ä—å–µ—Ä–∞]
Token created: [–ø–µ—Ä–≤—ã–µ 20 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–æ–∫–µ–Ω–∞]...
Cookie set with path: /
Mobile device: true
Production mode: true
HTTPS: false
SameSite policy: lax
Secure cookie: false
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–æ–±–∏–ª—å–Ω—ã–π cookie —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```

### 4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ middleware –ª–æ–≥–∏:**
–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
```
Middleware: –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞: /courier/dashboard
Middleware: –ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: true
Middleware: –¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω: true/false –î–ª–∏–Ω–∞: [–¥–ª–∏–Ω–∞ —Ç–æ–∫–µ–Ω–∞]
Middleware: –ú–æ–±–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω: true/false –î–ª–∏–Ω–∞: [–¥–ª–∏–Ω–∞ —Ç–æ–∫–µ–Ω–∞]
Middleware: –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω: true –î–ª–∏–Ω–∞: [–¥–ª–∏–Ω–∞ —Ç–æ–∫–µ–Ω–∞]
Middleware: –í—Å–µ cookies: [—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö cookies]
Middleware: Cookie auth-token: [–æ–±—ä–µ–∫—Ç cookie]
Middleware: Cookie auth-token-mobile: [–æ–±—ä–µ–∫—Ç cookie]
```

### 5. **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–π cookie `auth-token` —Å `sameSite: 'lax'`
- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π cookie `auth-token-mobile` —Å –º—è–≥–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- Middleware –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –æ–¥–∏–Ω –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ dashboard
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üîç –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è:

### **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ DevTools:**
1. **Application ‚Üí Cookies** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±–∞ cookie:
   - `auth-token` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
   - `auth-token-mobile` —Å –º—è–≥–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
2. **Console** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –º–æ–±–∏–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
3. **Network** - –∑–∞–ø—Ä–æ—Å –∫ `/api/courier/auth/login` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å–ø–µ—à–Ω—ã–º

### **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ cookies
- –ü—Ä–æ–±–ª–µ–º—ã —Å CORS
- Service Worker –±–ª–æ–∫–∏—Ä—É–µ—Ç cookies
- –ü—Ä–æ–±–ª–µ–º—ã —Å HTTPS –≤ production

## üìã –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### **API Login:**
- `sameSite: (isProduction && isMobile && isHttps) ? 'none' : 'lax'`
- `secure: isProduction && isHttps`
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–æ–±–∏–ª—å–Ω—ã–π cookie —Å –º—è–≥–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ cookie

### **Middleware:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–æ–∏—Ö cookie (`auth-token` –∏ `auth-token-mobile`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª—é–±–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ cookies
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### **Client Login:**
- localStorage backup –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

**–¢–µ–ø–µ—Ä—å –≤ production —Ä–µ–∂–∏–º–µ:**
- –î–ª—è HTTP: `sameSite: 'lax'`, `secure: false`
- –î–ª—è HTTPS: `sameSite: 'none'`, `secure: true` (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–æ–±–∏–ª—å–Ω—ã–π cookie —Å –º—è–≥–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–∞ cookie –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª—é–±–æ–π –¥–æ—Å—Ç—É–ø–Ω—ã–π

---

**–¢–µ–ø–µ—Ä—å cookie –¥–æ–ª–∂–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –≤ production —Ä–µ–∂–∏–º–µ!** üì±‚úÖ
